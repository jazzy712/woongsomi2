{% extends "base.html" %}
{% block content %}

<style>
  .profile-container {
    padding: 2rem;
    font-family: 'Segoe UI', sans-serif;
    animation: fadein 0.8s ease-in-out;
  }

  .section-card {
    background: #f0f8ff;
    border-radius: 16px;
    padding: 1.5rem;
    margin: 1.2rem 0;
    box-shadow: 0 6px 14px rgba(0, 0, 0, 0.08);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .section-card:hover {
    transform: scale(1.02);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.12);
  }

  .follow-btn {
    background: #D9EAFD;
    border: none;
    border-radius: 50%;
    padding: 10px 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  }

  .follow-btn:hover {
    transform: scale(1.2);
  }

  .fade-hover a {
    transition: color 0.2s ease, font-weight 0.2s ease;
  }

  .fade-hover a:hover {
    color: #2575fc;
    font-weight: bold;
  }

  @keyframes fadein {
    from {opacity: 0; transform: translateY(20px);}
    to {opacity: 1; transform: translateY(0);}
  }
</style>

<div class="profile-container">

  <!-- 프로필 상단 -->
  <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
    <h1 style="font-weight: bold; color: #2c3e50;">
      {% if request.user != person %}
        {{ person.username }}님의 프로필 페이지
      {% else %}
        나의 프로필 페이지
      {% endif %}
    </h1>

    {% if person.profile_image %}
      <img src="{{ person.profile_image.url }}" class="rounded-circle" style="width: 100px; height: 100px;">
    {% endif %}


    {% if request.user == person %}
      <a href="{% url 'accounts:update' %}" class="btn btn-outline-secondary">프로필 수정</a>
    {% endif %}


    <div style="font-size: 1rem; color: #555;">
      팔로잉: <strong>{{ person.followings.count }}</strong> /
      팔로워: <strong>{{ person.followers.count }}</strong>
    </div>
    
    {% if request.user != person %}
    <form action="{% url 'accounts:follow' person.pk %}" method="POST">
      {% csrf_token %}
      <button type="submit" class="follow-btn">
        {% if request.user in person.followers.all %}
          <i class="fas fa-heart" style="color: red; font-size: 1.5rem;"></i>
        {% else %}
          <i class="far fa-heart" style="color: black; font-size: 1.5rem;"></i>
        {% endif %}
      </button>
    </form>
    {% endif %}
    
    </div>
  </div>

  <!-- 게시글 -->
  {% comment %} <div class="section-card fade-hover">
    <h2>📌 {% if request.user != person %}{{ person.username }}님의 게시글{% else %}내 게시글{% endif %}</h2>
    {% for board in person.board_set.all %}
      <p>
        글제목:
        <a href="{% url 'boards:detail' board.pk %}">{{ board.title }}</a>
        <span style="color: #aaa;">#{{ board.pk }}</span>
      </p>
    {% empty %}
      <p style="color: #888;">작성한 게시글이 없습니다.</p>
    {% endfor %}
  </div> {% endcomment %}
  <div class="section-card">
    <h2>💼 가입한 금융 상품</h2>
    {% if person.joined_products %}
      <p>{{ person.joined_products }}</p>
    {% else %}
      <p style="color: #888;">아직 가입한 상품이 없습니다.</p>
    {% endif %}
  </div>
  <div class="section-card">
  <h2>📌 {% if request.user != person %}{{ person.username }}님의 게시글{% else %}내 게시글{% endif %}</h2>

  {% if person.board_set.all %}
    {% for board in person.board_set.all %}
      <div class="section-card" style="background: #fff; padding: 1rem; margin-top: 1rem;">
        <a href="{% url 'boards:detail' board.pk %}" style="text-decoration: none; color: #2c3e50;">
          <h4 style="margin-bottom: 0.4rem;">📝 {{ board.title }}</h4>
        </a>
        <div style="font-size: 14px; color: #555;">
          📎 글 번호: #{{ board.pk }} /
          📅 작성일: {{ board.created_at|date:"Y.m.d H:i" }} /
          💬 댓글: {{ board.comments.count }}
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p style="color: #888;">작성한 게시글이 없습니다.</p>
  {% endif %}
</div>

  <!-- 댓글 -->
  {% comment %} <div class="section-card">
    <h2>💬 {% if request.user != person %}{{ person.username }}님의 댓글{% else %}내 댓글{% endif %}</h2>
    {% for comment in person.comment_set.all %}
      <p style="margin-bottom: 0.8rem;">“{{ comment.content }}”</p>
    {% empty %}
      <p style="color: #888;">작성한 댓글이 없습니다.</p>
    {% endfor %}
  </div> {% endcomment %}

  <div class="section-card">
  <h2>💬 {% if request.user != person %}{{ person.username }}님의 댓글{% else %}내 댓글{% endif %}</h2>

  {% if person.comment_set.all %}
    {% for comment in person.comment_set.all %}
      <div class="section-card" style="background: #fff; padding: 1rem; margin-top: 1rem;">
        <p style="margin-bottom: 0.5rem; color: #2c3e50;">
          🗨️ “{{ comment.content }}”
        </p>
        <div style="font-size: 13px; color: #777;">
          📌 게시글: 
          <a href="{% url 'boards:detail' comment.board.pk %}" style="color: #2575fc; text-decoration: none;">
            {{ comment.board.title }}
          </a>
          /
          📅 작성일: {{ comment.created_at|date:"Y.m.d H:i" }}
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p style="color: #888;">작성한 댓글이 없습니다.</p>
  {% endif %}
</div>
  <!-- 팔로워 -->
  <div class="section-card">
    <h2>👥 Follower</h2>
    {% if person.followers.all %}
      {% for follower in person.followers.all %}
        <div class="section-card" style="background: #fff; padding: 1rem; margin-top: 1rem;">
          <a href="{% url 'accounts:profile' follower.pk %}" style="text-decoration: none; color: #2c3e50;">
            <h4 style="margin-bottom: 0.3rem;">👤 {{ follower.username }}</h4>
          </a>
          <div style="font-size: 14px; color: #555;">
            📝 게시글: {{ follower.board_set.count }} /
            🤝 팔로잉: {{ follower.followings.count }} /
            💬 팔로워: {{ follower.followers.count }}
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p style="color: #888;">Follower가 없습니다.</p>
    {% endif %}
  </div>

</div>

{% endblock content %}